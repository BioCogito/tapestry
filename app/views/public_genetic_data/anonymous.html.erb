<h2>Public anonymous genetic data</h2>

<%= form_tag(public_genetic_data_path, :method => 'get') do -%>
<%= select_tag :data_type, options_for_select(@data_type_options, params[:data_type]) %>
<%= submit_tag 'Search' %>
<% end %>

<table class="admin_table">
  <tr>
    <th>Source<br/>Date&nbsp;published</th>
    <th>Data type</th>
    <th>ID</th>
    <th>Download</th>
    <% if current_user and current_user.is_admin? %>
    <th style="text-align:center">Admin</th>
    <% end %>
  </tr>
  <% @datasets.each do |dataset| -%>
    <tr class="<%= cycle 'even', 'odd' %>">
      <td>
	PGP
	<br />
	<%= (dataset.respond_to?(:published_anonymously_at) ? dataset.published_anonymously_at : dataset.created_at).strftime('%Y-%m-%d') %>
      </td>
      <td><%= dataset.data_type %></td>
      <td><%= dataset.get_evidence_genome_id %></td>
      <td>
	<% if dataset.download_url %>
	<%= link_to 'Download', dataset.download_url %>
	<%= "(#{number_to_human_size(dataset.data_size)})" if dataset.data_size %>
	<%= link_to 'Download GFF file', dataset.download_url.gsub(/download_genome_id/,'download_type=ns&download_genome_id') %>
	<% end %>
      </td>
      <% if current_user and current_user.is_admin? %>
      <td style="text-align:center">
	<div style="display:inline-block">
	  <%= link_to 'Edit user', edit_admin_user_path(dataset.participant) %>
	</div>
      </td>
      <% end %>
    </tr>
  <% end %>
</table>
